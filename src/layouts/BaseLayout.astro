---
import '../styles/global.css';

interface Props {
  title: string;
  description: string;
  image?: string;
  canonicalUrl?: string;
  noindex?: boolean;
  schema?: Record<string, unknown>[];
}

const {
  title,
  description,
  image = 'https://source.unsplash.com/1200x630/?travel,luxury',
  canonicalUrl,
  noindex = false,
  schema = []
} = Astro.props;

const siteUrl = 'https://blog.otherwhere.world';
const fullImageUrl = image.startsWith('http') ? image : `${siteUrl}${image}`;
const canonical = canonicalUrl || Astro.url.href;

// Base organization schema
const orgSchema = {
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "Otherwhere",
  "description": "AI travel concierge: text or call to get curated trip options and booking help.",
  "url": "https://otherwhere.world",
  "telephone": "+1-323-922-4067"
};

const websiteSchema = {
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "Otherwhere",
  "url": siteUrl
};

const allSchemas = [orgSchema, websiteSchema, ...schema];
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />

    <!-- DNS Prefetch for external resources -->
    <link rel="dns-prefetch" href="https://images.unsplash.com" />
    <link rel="dns-prefetch" href="https://www.googletagmanager.com" />
    <link rel="dns-prefetch" href="https://images.squarespace-cdn.com" />

    <!-- Preconnect for critical resources -->
    <link rel="preconnect" href="https://images.unsplash.com" crossorigin />

    <!-- Google Fonts: Anton (headlines) + Hanken Grotesk (body) -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Anton&family=Hanken+Grotesk:wght@400;500;600&display=swap" rel="stylesheet" />

    <title>{title}</title>
    <meta name="title" content={title} />
    <meta name="description" content={description} />

    <link rel="canonical" href={canonical} />

    {noindex && <meta name="robots" content="noindex, nofollow" />}

    <!-- Open Graph -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={canonical} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={fullImageUrl} />
    <meta property="og:site_name" content="Otherwhere" />

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content={canonical} />
    <meta property="twitter:title" content={title} />
    <meta property="twitter:description" content={description} />
    <meta property="twitter:image" content={fullImageUrl} />

    <!-- Schema.org -->
    {allSchemas.map((s) => (
      <script type="application/ld+json" set:html={JSON.stringify(s)} />
    ))}

    <!-- Prefetch for navigation -->
    <link rel="prefetch" href="/blog" />
    <link rel="prefetch" href="/destinations" />
    <link rel="prefetch" href="/case-studies" />

    <!-- Google Analytics (deferred) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-73EZV154PS"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-73EZV154PS', { 'anonymize_ip': true });
    </script>
  </head>

  <body class="min-h-screen bg-paper">
    <!-- Sticky header -->
    <header class="sticky top-0 z-50 bg-paper border-b border-paper-tertiary">
      <nav class="max-w-wide mx-auto px-6 py-5 flex items-center justify-between">
        <a href="/" class="block">
          <img
            src="https://images.squarespace-cdn.com/content/v1/690665841a49334c4700cbbe/80c79faa-2735-4b95-bf5b-dfb9af632b69/otherwhere.png?format=500w"
            alt="Otherwhere"
            class="h-5 w-auto"
          />
        </a>
        <div class="flex items-center gap-10">
          <a href="/case-studies" class="nav-link-caps hidden sm:block">TRIPS</a>
          <a href="/destinations" class="nav-link-caps hidden sm:block">DESTINATIONS</a>
          <a href="/what-is-otherwhere" class="nav-link-caps hidden sm:block">ABOUT</a>
          <a
            href="sms:+13239224067"
            class="btn-pill btn-pill-primary"
          >
            TEXT US
          </a>
        </div>
      </nav>
    </header>

    <main>
      <slot />
    </main>

    <!-- Footer -->
    <footer class="border-t border-paper-tertiary mt-20">
      <div class="max-w-wide mx-auto px-6 py-16">
        <div class="grid md:grid-cols-4 gap-12 mb-16">
          <div>
            <img
              src="https://images.squarespace-cdn.com/content/v1/690665841a49334c4700cbbe/80c79faa-2735-4b95-bf5b-dfb9af632b69/otherwhere.png?format=500w"
              alt="Otherwhere"
              class="h-5 w-auto mb-6"
            />
            <p class="text-sm text-ink-secondary leading-relaxed">
              Personal travel booking.<br />
              Text us at (323) 922-4067
            </p>
          </div>
          <div>
            <p class="text-xs uppercase tracking-widest text-ink-tertiary mb-6">EXPLORE</p>
            <ul class="space-y-3 text-sm">
              <li><a href="/what-is-otherwhere" class="footer-link">What is Otherwhere?</a></li>
              <li><a href="/otherwhere-vs-chatgpt" class="footer-link">Otherwhere vs ChatGPT</a></li>
              <li><a href="/what-is-ai-travel-concierge" class="footer-link">AI Travel Concierge</a></li>
            </ul>
          </div>
          <div>
            <p class="text-xs uppercase tracking-widest text-ink-tertiary mb-6">TRIPS</p>
            <ul class="space-y-3 text-sm">
              <li><a href="/case-studies" class="footer-link">Case Studies</a></li>
              <li><a href="/destinations" class="footer-link">Destinations</a></li>
              <li><a href="/blog" class="footer-link">Blog</a></li>
            </ul>
          </div>
          <div>
            <p class="text-xs uppercase tracking-widest text-ink-tertiary mb-6">CONNECT</p>
            <ul class="space-y-3 text-sm">
              <li><a href="https://otherwhere.world" class="footer-link">Main Site</a></li>
              <li><a href="sms:+13239224067" class="footer-link">Text Us</a></li>
            </ul>
          </div>
        </div>
        <div class="border-t border-paper-tertiary pt-8 text-center text-xs uppercase tracking-widest text-ink-muted">
          &copy; {new Date().getFullYear()} OTHERWHERE
        </div>
      </div>
    </footer>
  </body>
</html>
